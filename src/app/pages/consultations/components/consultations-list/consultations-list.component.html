<div class="">
  <div class="consultations-list">
    <div class="consultations-header">
      <div class="header-left">
        <div class="search-and-filters">
          <div class="search-container">
            <div class="search-input-wrapper">
              <svg
                class="search-icon"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                />
              </svg>
              <input
                type="text"
                placeholder="Search for consultations..."
                formControlName="searchQuery"
                [formGroup]="filtersForm"
                class="search-input"
              />
              <button
                type="button"
                class="clear-search"
                *ngIf="filtersForm.get('searchQuery')?.value"
                (click)="filtersForm.get('searchQuery')?.setValue('')"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                  />
                </svg>
              </button>
            </div>
          </div>

          <button
            type="button"
            class="filters-toggle"
            [class.active]="showFiltersPanel"
            (click)="toggleFiltersPanel()"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z" />
            </svg>
            <span>Filters</span>
            <div
              class="filter-badge"
              *ngIf="filteredConsultations.length !== consultations.length"
            >
              {{ filteredConsultations.length }}
            </div>
          </button>
        </div>
      </div>

      <div class="header-right">
        <div class="view-toggle-wrapper">
          <div
            class="view-option"
            [class.active]="isDetailedView()"
            (click)="setDetailedView()"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" />
            </svg>
            <span>Detailed</span>
          </div>

          <div
            class="toggle-slider"
            [class.compact-mode]="isCompactView()"
            (click)="toggleViewMode()"
          >
            <div class="slider-track">
              <div class="slider-thumb" [class.moved]="isCompactView()"></div>
            </div>
          </div>

          <div
            class="view-option"
            [class.active]="isCompactView()"
            (click)="setCompactView()"
          >
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path
                d="M4 4h4v4H4V4zm6 0h4v4h-4V4zm6 0h4v4h-4V4zM4 10h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4zM4 16h4v4H4v-4zm6 0h4v4h-4v-4zm6 0h4v4h-4v-4z"
              />
            </svg>
            <span>Compact</span>
          </div>
        </div>
      </div>
    </div>

    <div
      class="filters-panel"
      [class.expanded]="showFiltersPanel"
      [formGroup]="filtersForm"
    >
      <div class="filters-content">
        <div class="filter-group">
          <label class="filter-label">Price</label>
          <div class="price-range">
            <input
              type="number"
              formControlName="priceMin"
              placeholder="From"
              class="price-input"
            />
            <span class="price-separator">—</span>
            <input
              type="number"
              formControlName="priceMax"
              placeholder="To"
              class="price-input"
            />
          </div>
        </div>

        <div class="filter-group" *ngIf="availableCategories.length > 0">
          <label class="filter-label">Категории</label>
          <div class="filter-chips">
            <label
              *ngFor="let category of availableCategories"
              class="filter-chip"
            >
              <input
                type="checkbox"
                [value]="category"
                (change)="onCategoryChange($event, category)"
              />
              <span>{{ category }}</span>
            </label>
          </div>
        </div>
        <div class="filter-group" *ngIf="availableCoaches.length > 0">
          <label class="filter-label">Coaches</label>
          <div class="filter-chips">
            <label *ngFor="let coach of availableCoaches" class="filter-chip">
              <input
                type="checkbox"
                [value]="coach"
                (change)="onCoachChange($event, coach)"
              />
              <span>{{ coach }}</span>
            </label>
          </div>
        </div>
        <div class="filter-group">
          <label class="filter-label">Sorting</label>
          <div class="sort-controls">
            <select formControlName="sortBy" class="sort-select">
              <option value="date">By date</option>
              <option value="price">By price</option>
              <option value="rating">By rating</option>
              <option value="duration">By duration</option>
              <option value="popularity">By popularity</option>
            </select>
            <button
              type="button"
              class="sort-order-toggle"
              (click)="toggleSortOrder()"
              [title]="
                filtersForm.get('sortOrder')?.value === 'asc'
                  ? 'Ascending'
                  : 'Descending'
              "
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path
                  *ngIf="filtersForm.get('sortOrder')?.value === 'asc'"
                  d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"
                />
                <path
                  *ngIf="filtersForm.get('sortOrder')?.value === 'desc'"
                  d="M3 6h6v2H3V6zm0 7h12v2H3v-2zm0 7h18v-2H3v2z"
                />
              </svg>
            </button>
          </div>
        </div>

        <div class="filter-actions">
          <button
            type="button"
            class="reset-filters-btn"
            (click)="resetFilters()"
          >
            Clear
          </button>
          <button
            type="button"
            class="apply-filters-btn"
            (click)="toggleFiltersPanel()"
          >
            Apply ({{ filteredConsultations.length }})
          </button>
        </div>
      </div>
    </div>
    <div
      class="consultation-wrapper"
      *ngFor="let consultation of consultations"
    >
      <cons-consultation-card [model]="consultation"></cons-consultation-card>
    </div>
  </div>
</div>